<!DOCTYPE html>
<!--
	Solid State by HTML5 UP	html5up.net | @ajlkn	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)-->
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>Nuno Lopes-Data Analyst</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="assets/css/main.css">
    <noscript><link rel="stylesheet" href="assets/css/noscript.css"></noscript>
  </head>
  <body class="is-preload">
    <!-- Page Wrapper -->
    <div id="page-wrapper">
      <!-- Header -->
      <header id="header">
        <h1><a href="index.html">Nuno Lopes</a></h1>
        <nav> <a href="#menu">Menu</a> </nav>
      </header>
      <!-- Menu -->
      <nav id="menu">
        <div class="inner">
          <h2>Menu</h2>
          <ul class="links">
            <li><a href="index.html">Home</a></li>
            <li><a href="projects.html">projects</a></li>
            <li><a href="about.html">about</a></li>
          </ul>
          <a href="#" class="close">Close</a> </div>
      </nav>
      <!-- Wrapper -->
      <section id="wrapper">
        <header>
          <div class="inner">
            <h2>Covid-19 tableau dashboard</h2>
            <p>Global numbers visualization dashboard in tableau.</p>
          </div>
        </header>
        <!-- Title pictures -->
        <section>
          <div class="wrapper">
            <div class="inner">
              <h3 class="major">covid-19 Tableau dashboard</h3>
              <div class="box alt">
                <div class="row gtr-uniform">
                  <div class="col-12"><span class="image fit"><img src="images/da_3_1.jpg"
                        alt=""></span></div>
                  <div class="col-4"><span class="image fit"><img src="images/da3_1.jpg"
                        alt=""></span></div>
                  <div class="col-4"><span class="image fit"><img src="images/da3_2.jpg"
                        alt=""></span></div>

                </div>
              </div>
            </div>
          </div>
        </section>

        <!-- Content -->
        <div class="wrapper">
          <div class="inner">
            <h3 class="major">Dataset</h3>
            <p>Coronavirus Pandemic (COVID-19)</p>
            <p>Hannah Ritchie, Esteban Ortiz-Ospina, Diana Beltekian, Edouard
              Mathieu, Joe Hasell, Bobbie Macdonald, Charlie Giattino, Cameron
              Appel, Lucas Rodés-Guirao and Max Roser (2020) "Coronavirus
              Pandemic (COVID-19)". Published online at OurWorldInData.org.
              Retrieved from: 'https://ourworldindata.org/coronavirus' [Online
              Resource]</p>
            <h3 class="major">Data Preparation</h3>
            <p>Since I haven't liked our database directely with Tableau, I have prepared the following code in Python that will pull the data for our vizualization from SQL Server so we can import it to Tableau.</p>
            <h4>Python code</h4>
            <pre><code>#Import the necessary packages
import os
import glob 
import pandas as pd
from datetime import datetime
import pyodbc</code></pre>  

<pre><code>#Setup a SQL Server connection
  conn_str = (
      r'Driver=SQL Server Native Client 11.0;'
      r'Server=.\SQLEXPRESS;'
      r'Database=Coronavirus;'
      r'Trusted_Connection=yes;'
      )</code></pre>  
            <p>Now we can just do a simple query to get the data from our previously created SQL Views.</p>
            <pre><code>query_1 = '''SELECT * FROM [dbo].[v_global_deaths]'''
table_1 = pd.read_sql_query(query_1, cnxn)

query_2 = '''SELECT * FROM [dbo].[v_continent_deaths]'''
table_2 = pd.read_sql_query(query_2, cnxn)

query_3 = '''SELECT * FROM [dbo].[v_country_infection]'''
table_3 = pd.read_sql_query(query_3, cnxn)

query_4 = '''SELECT * FROM [dbo].[v_country_infection_details]'''
table_4 = pd.read_sql_query(query_3, cnxn)</code></pre>  
            <p>Once the data is queried we just need to export it to csv files</p>
<pre><code>#Export as an Excel file
table_1.to_excel('1_global_deaths.xlsx', sheet_name='global_deaths', index = False)
table_2.to_excel('2_continent_deaths.xlsx', sheet_name='continent_deaths', index = False)
table_3.to_excel('3_country_infection.xlsx', sheet_name='country_infection', index = False)
table_4.to_excel('4_country_infection_details.xlsx', sheet_name='country_infection_details', index = False)</code></pre>

            <h3 class="major">Data Vizualization</h3>
            <p>some notes</p>
            <!--Vizualization script from tableau-->
            <h3 class="major">Tableau</h3>
            <div class='tableauPlaceholder' id='viz1633553694068' style='position: relative'><noscript><a href='#'><img alt='Dashboard ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Co&#47;Coviddatavizualization&#47;Dashboard&#47;1_rss.png' style='border: none' /></a></noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> <param name='site_root' value='' /><param name='name' value='Coviddatavizualization&#47;Dashboard' /><param name='tabs' value='no' /><param name='toolbar' value='yes' /><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Co&#47;Coviddatavizualization&#47;Dashboard&#47;1.png' /> <param name='animate_transition' value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' value='yes' /><param name='language' value='en-US' /></object></div>                <script type='text/javascript'>                    var divElement = document.getElementById('viz1633553694068');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.minWidth='420px';vizElement.style.maxWidth='1150px';vizElement.style.width='100%';vizElement.style.minHeight='587px';vizElement.style.maxHeight='787px';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.minWidth='420px';vizElement.style.maxWidth='1150px';vizElement.style.width='100%';vizElement.style.minHeight='587px';vizElement.style.maxHeight='787px';vizElement.style.height=(divElement.offsetWidth*0.75)+'px';} else { vizElement.style.width='100%';vizElement.style.height='1077px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
 
            <p></p>
            <h3 class="major">Linked projects</h3>
            <section class="features">
              <article> <a href="#" class="image"><img src="images/pic04.jpg" alt=""></a>
                <h3 class="major">Sed feugiat lorem</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing vehicula
                  id nulla dignissim dapibus ultrices.</p>
                <a href="#" class="special">Learn more</a> </article>
              <article> <a href="#" class="image"><img src="images/pic05.jpg" alt=""></a>
                <h3 class="major">Nisl placerat</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing vehicula
                  id nulla dignissim dapibus ultrices.</p>
                <a href="#" class="special">Learn more</a> </article>
            </section>
          </div>
        </div>
      </section>
      <!-- Footer -->
      <section id="footer">
        <div class="inner">
          <h2 class="major">Contacts</h2>
          <ul class="contact">
            <li class="icon solid fa-home"> Lisbon</li>
            <li class="icon solid fa-phone">(351) 965-565-5351</li>
            <li class="icon solid fa-envelope"><a href="mailto:nuno.j.lopes@outlook.com">nuno.j.lopes@outlook.com</a></li>
            <li class="icon brands fa-github"><a href="https://github.com/nunojlopes">guithub</a></li>
            <li class="icon brands fa-facebook-f"><a href="https://www.facebook.com/nuno.lopes.520562">facebook.com/nuno.lopes.520562</a></li>
          </ul>
          <ul class="copyright">
            <li>© Nuno Lopes. All rights reserved.</li>
            <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
          </ul>
        </div>
      </section>
    </div>
    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
  </body>
</html>
